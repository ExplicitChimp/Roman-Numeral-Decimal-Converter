This code is courtesy of a friend who has not got GitHub.

